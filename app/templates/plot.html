<!DOCTYPE html>
<html lang="en">
  <head
    data-session_file="{{ sessionfile }}"
    data-genesfile="{{ genesfile }}"
    data-SSPvalues_file="{{ SSPvalues_file }}"
    data-coloc2_file="{{ coloc2_file }}"
    data-sessionid="{{ sessionid }}"
    data-metadata_file="{{ metadata_file }}"
    data-static_endpoint="{{ url_for('static', filename='') }}"
  >
    {% include "lib/google-analytics.html" %}
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>
      LocusFocus: A Colocalization Tool to Prioritize Genes and Tissues from
      GWAS and eQTL Integration
    </title>
    <link rel="shortcut icon" href="#" />
    <!-- Font Awesome -->
    <link
      rel="stylesheet"
      href="https://use.fontawesome.com/releases/v5.7.0/css/all.css"
    />
    <!-- Bootstrap core CSS -->
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
      integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T"
      crossorigin="anonymous"
    />
    <!-- Material Design Bootstrap -->
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.7.4/css/mdb.min.css"
      rel="stylesheet"
    />
    <!-- DataTables -->

    <link
      href="https://cdn.datatables.net/v/dt/jq-3.7.0/dt-2.3.4/datatables.min.css"
      rel="stylesheet"
      integrity="sha384-R5Azes02wvL9ervyq6xo5WLyg1ufX0qwun0F/0qos0E0wNjnnRTADTQpjpnNLakj"
      crossorigin="anonymous"
    />

    <!--local stylesheets-->
    <link
      rel="stylesheet"
      type="text/css"
      href="{{ url_for('static', filename='css/style.css') }}"
    />
    <link
      rel="stylesheet"
      type="text/css"
      href="{{ url_for('static', filename='css/d3Style.css') }}"
    />
  </head>

  <body>
    {% include "components/navigation-bar.html" %}
    <div class="container">
      <div class="row">
        <div class="col-md-12 d-flex justify-content-center align-items-center">
          <div class="card border-primary mb-9">
            <div class="card-header">Session ID</div>
            <div class="card-body">
              <h4 class="card-title" id="sessionid"></h4>
              <p class="card-text">
                Save the above string for your records to load or share your
                plot.
              </p>
              <p class="card-text">Plots older than 7 days are deleted.</p>
            </div>
          </div>
        </div>
      </div>
      <hr />
      <div class="row">
        <div class="col-md-12" id="snpWarning" name="snpWarning"></div>
      </div>

      <div class="d-flex justify-content-center" id="loading-spinner">
        <div class="spinner-border" role="status">
          <span class="sr-only">Loading...</span>
        </div>
      </div>

      <div class="row" id="params-table-row" hidden>
        <div class="col-md-12">
          <table
            id="params-table"
            class="table table-striped table-bordered table-condensed table-sm sortable"
            cellspacing="0"
            width="90%"
          ></table>
        </div>
      </div>
      <hr id="params-table-divider" hidden />

      <div class="row" id="plot-row" hidden>
        <div class="col-md-12">
          <h3>Colocalization Plot</h3>
          <select id="selGene" onchange="optionChanged(this.value)"></select>
          <div id="plot_message" class="isa_info"></div>

          <div class="row">
            <div class="col-md-6">
              <input
                type="checkbox"
                id="pval-filter"
                name="pval-filter"
                onclick="plot_fullgwas(this)"
                checked
              /><label
                for="pval-filter"
                data-toggle="tooltip"
                data-html="true"
                title="
              <p>
                If unchecked, all GWAS p-values above 0.1 will be shown (slower
                to load and plot).
              </p>
              "
              >
                Uncheck to draw all GWAS points below -log<sub>10</sub>P &lt; 1
                (slow)
              </label>
            </div>
          </div>
          <div id="plot"></div>
          <div class="row">
            <div class="col-md-3">
              <input
                class="form-control"
                id="colocPlotWidth"
                name="colocPlotWidth"
                type="text"
                placeholder="Width (e.g. 1080)"
              />
            </div>
            <div class="col-md-3">
              <input
                class="form-control"
                id="colocPlotHeight"
                name="colocPlotHeight"
                type="text"
                placeholder="Height (e.g. 1080)"
              />
            </div>
            <div class="col-md-3">
              <input
                class="form-control"
                id="eqtlWindow"
                name="eqtlWindow"
                type="text"
                placeholder="Lines window size (e.g. 300)"
                data-toggle="tooltip"
                title="This determines the window size for the minP line traces; use -1 for default"
              />
            </div>
            <div class="col-md-3">
              <input
                class="form-control"
                id="pctOneChar"
                name="pctOneChar"
                type="text"
                placeholder="One character space (e.g. 0.020)"
                data-toggle="tooltip"
                title="This is the fraction occupied by one character for the gene names; change this if gene names are not appearing"
              />
            </div>
          </div>
          <br />
          <div class="row">
            <div class="col-md-3">
              <input
                class="form-control"
                id="colocPlotFontSize"
                name="colocPlotFontSize"
                type="text"
                placeholder="Global font size (e.g. 14)"
              />
            </div>
            <div class="col-md-3">
              <input
                class="form-control"
                id="legendOffset"
                name="legendOffset"
                type="text"
                placeholder="Legend offset (e.g. 0.1)"
                data-toggle="tooltip"
                title="If the legend is overlapping the plot, you may want to increase the offset"
              />
            </div>
          </div>
          <div class="row">
            <div class="col-md-3">
              <input
                id="colocPlot-redraw-btn"
                type="submit"
                class="btn btn-default"
                value="Update"
              />
            </div>
            <div class="col-md-3">
              <input
                id="colocPlot-svg-btn"
                type="submit"
                class="btn btn-default"
                value="Generate SVG"
              />
            </div>
          </div>
          <p></p>
          <div class="alert alert-dismissible alert-info">
            <button type="button" class="close" data-dismiss="alert">
              &times;
            </button>
            <strong
              >Tissues selected but not drawn are due to unavailable eQTL data,
              likely due to little or no expression in that tissue</strong
            >
          </div>
        </div>
      </div>
      <hr id="plot-divider" hidden />

      <div class="row" id="heatmap-row" hidden>
        <div class="col-md-12">
          <h3>
            Heatmap of Simple Sum Colocalization P-values for GTEx Tissues
            Selected
          </h3>
          <div id="heatmap"></div>
          <div class="gtex_heatmap_message"></div>
          <div class="row">
            <div class="col-md-3">
              <!-- <label for="heatmapwidth" id="heatmap-width">Width</label> -->
              <input
                class="form-control"
                id="heatmapWidth"
                name="heatmapWidth"
                type="text"
                placeholder="Width (e.g. 1080)"
              />
            </div>
            <div class="col-md-3">
              <!-- <label for="heatmapheight" id="heatmap-height">Height</label> -->
              <input
                class="form-control"
                id="heatmapHeight"
                name="heatmapHeight"
                type="text"
                placeholder="Height (e.g. 1080)"
              />
            </div>
            <div class="col-md-3">
              <input
                class="form-control"
                id="heatmapFontsize"
                name="heatmapFontsize"
                type="text"
                placeholder="Global font size (e.g. 14)"
              />
            </div>
          </div>
          <div class="row">
            <div class="col-md-3">
              <input
                id="heatmap-redraw-btn"
                type="submit"
                class="btn btn-default"
                value="Update"
              />
            </div>
            <div class="col-md-3">
              <input
                id="heatmap-svg-btn"
                type="submit"
                class="btn btn-default"
                value="Generate SVG"
              />
            </div>
          </div>
          <p></p>
          <div class="alert alert-dismissible alert-info">
            <button type="button" class="close" data-dismiss="alert">
              &times;
            </button>
            <p>
              <strong
                >Gray cells (with negative -log10 Simple Sum p-values)
                correspond to gene-tissue pairs with no Simple Sum (SS)
                P-value.<br />
                The exact reason for the absence of a SS P-value can be gleaned
                in the table below
              </strong>
            </p>
            {% include "components/first-stage-significance-notice.html" %}
          </div>
        </div>
      </div>
      <hr id="heatmap-divider" hidden />

      <div class="row" id="variants-table-row" hidden>
        <div class="col-md-12">
          <div id="table-area">
            <h3>
              Simple Sum -log10 P-values Table for GTEx Genes/Tissues Selected
            </h3>
            <div class="gtex_heatmap_message"></div>

            <div class="row">
              <div class="col-md-12">
                <input
                  id="transpose-button"
                  type="submit"
                  name="transpose-button"
                  class="btn btn-default"
                  value="Transpose"
                  onclick="transposeTable();"
                />
              </div>
            </div>

            <table
              id="variants-table"
              class="table table-striped table-bordered table-condensed table-sm sortable"
              cellspacing="0"
              width="90%"
            >
              <thead>
                <tr>
                  <th class="th-sm" id="GeneOrTissue"></th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
          <!-- table-area closing div -->
          {% include "components/simplesum-notice.html" %}
        </div>
        <!-- col-md-12 closing div -->
      </div>
      <hr id="variants-table-divider" hidden />

      <div class="row" id="numSSsnpsUsed-table-row" hidden>
        <div class="col-md-12">
          <div id="table-area">
            <h3>
              Number of SNPs Used for Simple Sum Calculation for GTEx
              Genes/Tissues Selected
            </h3>
            <table
              id="numSSsnpsUsed-table"
              class="table table-striped table-bordered table-condensed table-sm sortable"
              cellspacing="0"
              width="90%"
            >
              <thead></thead>
              <tbody></tbody>
            </table>
          </div>
          <!-- table-area closing div -->
        </div>
        <!-- col-md-12 closing div -->
      </div>
      <!-- row closing div -->
      <hr id="numSSsnpsUsed-table-divider" hidden />

      <div class="row" id="secondary-table-row" hidden>
        <div class="col-md-12">
          <div id="table-area">
            <h3>
              Simple Sum -log10 P-values Table for Secondary Datasets Uploaded
            </h3>
            <div class="secondary_datasets_message"></div>
            <table
              id="secondary-table"
              class="table table-striped table-bordered table-condensed table-sm sortable"
              cellspacing="0"
              width="90%"
            ></table>
          </div>
          <!-- table-area closing div -->
          {% include "components/simplesum-notice.html" %}
        </div>
        <!-- col-md-12 closing div -->
      </div>
      <!-- row closing div -->
      <hr id="secondary-table-divider" hidden />

      <div class="row" id="SSguidance-table-row" hidden>
        <div class="col-md-12">
          <div id="table-area">
            <h3>Simple Sum Guidance Summary</h3>
            <table
              id="SSguidance-table"
              class="table table-striped table-bordered table-condensed table-sm sortable"
              cellspacing="0"
              width="90%"
            >
              <thead></thead>
              <tbody></tbody>
            </table>
            <div id="SS_guidance"></div>
          </div>
          <!-- table-area closing div -->
        </div>
        <!-- col-md-12 closing div -->
      </div>
      <!-- row closing div -->
      <hr id="SSguidance-table-divider" hidden />

      <div class="row" id="coloc2-table-row" hidden>
        <div class="col-md-12">
          <div id="coloc2-table-area">
            <h3>COLOC2 Posterior Probability Results Table</h3>
            <div id="coloc2-message"></div>
            <table
              id="coloc2-table"
              class="table table-striped table-bordered table-condensed table-sm sortable"
              cellspacing="0"
              width="90%"
            ></table>
          </div>
        </div>
      </div>
      <hr id="coloc2-table-divider" hidden />

      <div class="row" id="set-based-test-table-row" hidden>
        <div class="col-md-12">
          <div id="table-area">
            <h3>
              Set-based Significance Test -log10 P-values Table for Datasets
              Uploaded
            </h3>
            <table
              id="set-based-test-table"
              class="table table-striped table-bordered table-condensed table-sm sortable"
              cellspacing="0"
              width="90%"
            ></table>
          </div>
          <!-- table-area closing div -->
        </div>
        <!-- col-md-12 closing div -->
      </div>
      <!-- row closing div -->
      <hr id="set-based-test-table-divider" hidden />

      <div class="row">
        <div class="col-md-4">
          <input
            id="download-btn"
            type="button"
            class="btn btn-default"
            value="Download Session Data"
            onclick="window.location.href = '/downloaddata/{{ sessionid }}';"
          />
        </div>
      </div>
    </div>
    <!-- container closing div -->

    <!-- JS -->

    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/5.9.1/d3.js"></script>
    <!-- JQuery -->
    <script
      type="text/javascript"
      src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"
    ></script>
    <!-- Plotly, strict bundle still does not solve all inline css callback errors -->
    <script src="https://cdn.jsdelivr.net/npm/plotly.js-strict-dist@3.1.0/plotly-strict.min.js"></script>
    <!-- datatables -->
    <script
      src="https://cdn.datatables.net/v/dt/jq-3.7.0/dt-2.3.4/datatables.min.js"
      integrity="sha384-mtJ3+H/dkUyvhmcXYSyIZyaeG0TnEkh91c1JwFkrkBLHBv8oQ3lFjUp8xfDan41b"
      crossorigin="anonymous"
    ></script>
    <!-- Bootstrap tooltips -->
    <script
      type="text/javascript"
      src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.4/umd/popper.min.js"
    ></script>
    <!-- MDB core JavaScript -->
    <script
      type="text/javascript"
      src="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.7.4/js/mdb.min.js"
    ></script>
    <!-- Bootstrap core JavaScript -->
    <script
      type="text/javascript"
      src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min.js"
    ></script>
    <!--local-->
    <script
      type="module"
      src="{{ url_for('static', filename='js/file-saver/src/FileSaver.js') }}"
    ></script>
    <script
      type="text/javascript"
      src="{{ url_for('static', filename='js/params_table.js') }}"
    ></script>
    <script
      type="text/javascript"
      src="{{ url_for('static', filename='js/plot_gwas.js') }}"
    ></script>
    <script
      type="text/javascript"
      src="{{ url_for('static', filename='js/plot_heatmap.js') }}"
    ></script>
    <script
      type="text/javascript"
      src="{{ url_for('static', filename='js/heatmap_table.js') }}"
    ></script>
    <script
      type="text/javascript"
      src="{{ url_for('static', filename='js/guidance_table.js') }}"
    ></script>
    <script
      type="text/javascript"
      src="{{ url_for('static', filename='js/coloc2table.js') }}"
    ></script>
    <script
      type="text/javascript"
      src="{{ url_for('static', filename='js/first_stage_table.js') }}"
    ></script>
    <script
      type="application/javascript"
      src="{{ url_for('static', filename='js/plot_coloc.js') }}"
    ></script>
  </body>
</html>
